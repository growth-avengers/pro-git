
# 트리
Git에서의 트리란 파일의 묶음을 의미한다. Git은 일반적으로 `HEAD`, `Index`, `워킹 디렉토리` 이렇게 세 가지의 트리를 관리한다. 이 중 Index는 엄밀히 말하면 트리는 아니지만 쉬운 이해를 위해 트리로 이야기 한다.   

이 중 워킹 디렉토리는 우리에게 익숙한 개념이지만 `HEAD`, `Index`는 생소한 개념이고, 이 파일들은 `.git` 디렉토리에 저장되어 있고, 그 내용은 효율적인 형태로 저장되어 있기 때문에 사용자가 알아보기 어렵다. 

| 트리          | 설명                          | 역할                                      |
| ------------- | ----------------------------- | ----------------------------------------- |
| HEAD          | 현재 브랜치를 가리키는 포인터 | 마지막 커밋 스냅샨, 다음 커밋의 부모 커밋 |
| Index         |                               | 다음에 커밋할 스냅샷                      |
| 워킹 디렉토리 |                               | 샌드박스                                  |

## HEAD
HEAD는 현재 브랜치를 가리키는 포인터이며, 브랜치는 해당 브랜치의 가장 마지막 커밋을 가리킨다. 쉽게 말하면 HEAD는 **현재 브랜치의 마지막 커밋의 스냅샷**이다.  

`git cat-file -p HEAD` 명령으로 HEAD가 가리키는 스냅샷을 살펴볼 수 있다.  
`git ls-tree -r HEAD` 명령으로 HEAD 스냅샷의 디렉토리 리스트와 각 파일의 SHA-1 체크섬을 확인할 수 있다.  

`cat-file`, `ls-tree`와 같은 명령은 일상적으로 사용하지 않는 저수준 명령인데, 이러한 저수준 명령을 `plumbing` 명령이라고 한다. 이러한 plumbing 명령어는 Git이 실제로 무슨 일을 하는지 확인할 때 유용하다.

## Index
Git에서Index, Staging Area, Cache는 모두 같은 의미로 사용된다. 

`git ls-files` 명령을 통해 현재 Index의 상태를 확인할 수 있다.  

Index는 실제로는 평평한 구조로 구현되어 있지만 이해를 돕기위해 트리라고 설명한다. 

## 트리 워크플로

![[20-01.png]]

| 순서 | 작업 내용          | 각 트리 비교 |
| ---- | ------------------ | ------------ |
| 1    | `git init` 또는 워킹 디렉토리 수정 | H  = I != W   |
| 2    | `git add`          | H != I  = W   |
| 3    | `git commit`       | H  = I  = W    |

`git init` 명령을 실행하면 Git 저장소가 생기지만 HEAD는 아직 없는 브랜치를 가리키지만 편의를 위해 해당 내용은 생략했다.  



