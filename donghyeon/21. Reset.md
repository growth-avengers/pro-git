# Reset의 동작

앞의 세 개의 트리 작동 구조와 `reset` 명령을 연결하면 이해하기 쉽다.   

![21-01](./00.images/21-01.png)

이 상태에서 `reset` 명령이 각 트리를 어떻게 조작하는지 알아보자

## 1단계: HEAD 이동(--soft)

![reset 1단계](./00.images/21-02.png)

HEAD는 계속 현재 브랜치를 가리키지만 현재 브랜치가 가리키는 커밋을 바꾼다. (`checkout` 명령은 HEAD가 가리키는 브랜치를 바꾼다.)

`git commit` 명령을 되돌리는 것이다. 

## 2단계: Index 업데이트(--mixed)

![reset 2단계](./00.images/21-03.png)

1단계를 진행하고 Staging Area를 비운다. 즉 `git commit`명령뿐아니라 `git add` 명령까지 되돌리는 것이다.

## 3단계: 워킹 디렉토리 업데이트(--hard)

![reset 3단계](./00.images/21-04.png)

Git에서 실제 데이터를 삭제하는 몇 안되는 방법 중 하나로 `--hard` 옵션을 사용할 때는 매우 주의해야 한다. `reflog`에 조회되면 복원할 수 있지만, 그렇지 않으면 복원은 불가능하다.  


## 정리
`reset` 명령은 정해진 순서대로 각 트리를 덮어쓴다. 어디까지 되돌릴지는 옵션에 따라 다르다.  

1. HEAD가 가리키는 브랜치를 옮긴다.(`--soft`)
2. Index를 HEAD가 가리키는 상태로 만든다.(`[--mixed]`)
3. 워킹 디렉토리를 Index의 상태로 만든다.(`--hard`)
